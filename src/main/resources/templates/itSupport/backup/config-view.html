<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>View Backup Configuration</title>
    <meta charset="UTF-8">
</head>
<body>
    <h1>Backup Configuration Details</h1>
    
    <div>
        <a href="/it-support/backup/configs">Back to Configurations</a> |
        <a th:href="@{/it-support/backup/configs/{id}/edit(id=${config.id})}">Edit Configuration</a>
    </div>
    
    <div>
        <h3>Configuration Name</h3>
        <p th:text="${config.name}"></p>
    </div>
    
    <div>
        <h3>Backup Type</h3>
        <p th:text="${config.backupType}"></p>
    </div>
    
    <div>
        <h3>Storage Location</h3>
        <p th:text="${config.storageLocation}"></p>
    </div>
    
    <div>
        <h3>Schedule</h3>
        <p th:text="${config.scheduledTime != null ? config.scheduledTime : 'Manual only'}"></p>
    </div>
    
    <div>
        <h3>Retention Period</h3>
        <p th:text="${config.retentionDays + ' days'}"></p>
    </div>
    
    <div>
        <h3>Status</h3>
        <p th:text="${config.active ? 'Active' : 'Inactive'}"></p>
    </div>
    
    <div>
        <h3>Last Modified</h3>
        <p th:text="${config.lastModified}"></p>
    </div>
    
    <div>
        <h3>Modified By</h3>
        <p th:text="${config.modifiedBy != null ? config.modifiedBy.fullName : 'Unknown'}"></p>
    </div>
    
    <h2>Backup History</h2>
    
    <a th:href="@{/it-support/backup/manual(configId=${config.id})}">Run Manual Backup</a>
    
    <table border="1">
        <thead>
            <tr>
                <th>Date/Time</th>
                <th>Status</th>
                <th>Size (MB)</th>
                <th>Initiated By</th>
                <th>Duration (min)</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr th:if="${history.empty}">
                <td colspan="6">No backup history found for this configuration</td>
            </tr>
            <tr th:each="backup : ${history}">
                <td th:text="${backup.startTime}"></td>
                <td th:text="${backup.status}"></td>
                <td th:text="${backup.fileSizeMb != null ? #numbers.formatDecimal(backup.fileSizeMb, 1, 2) : 'N/A'}"></td>
                <td th:text="${backup.initiatedBy + (backup.user != null ? ' by ' + backup.user.fullName : '')}"></td>
                <td th:text="${backup.durationMinutes != null ? backup.durationMinutes : 'In progress'}"></td>
                <td>
                    <a th:href="@{/it-support/backup/history/{id}(id=${backup.id})}">View</a> |
                    <a th:href="@{/it-support/backup/history/{id}/delete(id=${backup.id})}"
                       onclick="return confirm('Are you sure you want to delete this backup record?')">Delete</a>
                </td>
            </tr>
        </tbody>
    </table>
</body>
</html>